"use strict";(self["webpackChunkschool_canteen_backstage"]=self["webpackChunkschool_canteen_backstage"]||[]).push([[371],{6371:function(t,e,a){a.r(e),a.d(e,{default:function(){return d}});var i=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"header"},[t._v("公告管理")]),e("div",{staticClass:"container"},[e("div",{staticClass:"searchBox"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.search.keyword,expression:"search.keyword"}],staticClass:"searchInput",attrs:{type:"text",placeholder:"请输入查找内容"},domProps:{value:t.search.keyword},on:{input:function(e){e.target.composing||t.$set(t.search,"keyword",e.target.value)}}}),e("button",{staticClass:"searchBtn",attrs:{type:"button"},on:{click:t.searchNotice}},[t._v(" 搜索 ")]),e("button",{staticClass:"addBtn",attrs:{type:"button"},on:{click:t.addNotice}},[t._v(" 发布公告 ")])]),e("div",{staticClass:"listBox"},[e("div",{staticClass:"list"},[[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:""}},[e("el-table-column",{attrs:{prop:"nid",label:"公告ID",width:"120",align:"center"}}),e("el-table-column",{attrs:{prop:"title",label:"公告标题",width:"300",align:"center"}}),e("el-table-column",{attrs:{prop:"noticeDate",label:"修改日期",width:"150",align:"center"}}),e("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function({row:a}){return[e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.updateNotice(a)}}},[t._v("编辑查看 ")]),e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.deleteNotice(a.nid)}}},[t._v("删除公告")])]}}])})],1)]],2),e("div",{staticClass:"pager"},[e("el-pagination",{attrs:{"current-page":t.search.pagenum,"page-size":t.search.pageSize,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChangeFn,"update:currentPage":function(e){return t.$set(t.search,"pagenum",e)},"update:current-page":function(e){return t.$set(t.search,"pagenum",e)},"update:pageSize":function(e){return t.$set(t.search,"pageSize",e)},"update:page-size":function(e){return t.$set(t.search,"pageSize",e)}}})],1)])]),e("el-dialog",{attrs:{title:t.isEdit?"编辑公告":"发布公告",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[e("el-form",{attrs:{model:t.form}},[e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.form.nid,expression:"form.nid"}],attrs:{label:"公告ID","label-width":t.formLabelWidth}},[e("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:t.form.nid,callback:function(e){t.$set(t.form,"nid",e)},expression:"form.nid"}})],1),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.form.noticeDate,expression:"form.noticeDate"}],attrs:{label:"发布时间","label-width":t.formLabelWidth}},[e("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:t.form.noticeDate,callback:function(e){t.$set(t.form,"noticeDate",e)},expression:"form.noticeDate"}})],1),e("el-form-item",{attrs:{label:"公告标题","label-width":t.formLabelWidth}},[e("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),e("el-form-item",{attrs:{label:"公告详情","label-width":t.formLabelWidth}},[e("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",maxlength:"300",autosize:{minRows:4,maxRows:3},"show-word-limit":""},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.sureBtn}},[t._v("确 定")])],1)],1)],1)},s=[],o=a(586),r={name:"noticeCMD",data(){return{search:{pagenum:1,pageSize:6,keyword:""},isEdit:!1,total:100,dialogFormVisible:!1,formLabelWidth:"120px",form:{nid:"",title:"",noticeDate:"",content:""},tableData:[]}},methods:{addNotice(){this.isEdit=!1,this.dialogFormVisible=!0,this.clearnForm()},async addNoticeFn(){const{data:t}=await(0,o.OP)(this.form);if(0!=t.code)return this.$message.error("添加公告失败！");this.$message.success("添加公告成功！"),this.getNoticeList(),this.dialogFormVisible=!1},updateNotice(t){this.isEdit=!0,this.form={...t},this.dialogFormVisible=!0},async updateNoticeFn(){const{data:t}=await(0,o.Uy)(this.form);if(0!=t.code)return this.$message.error("公告编辑失败！");this.$message.success("公告编辑成功！"),this.getNoticeList(),this.dialogFormVisible=!1},async deleteNotice(t){const e=await this.$confirm("是否确认删除公告！！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((t=>t));if("cancel"===e)return;const{data:a}=await(0,o.$E)({id:t});if(0!=a.code)return this.$message.error("删除公告失败！");this.$message.success("删除成功！"),this.search.pagenum=1,this.getNoticeList()},async getNoticeList(){const{data:t}=await(0,o.pv)({page:this.search.pagenum,title:this.search.keyword});if(console.log(t),0!=t.code)return this.$message.error("获取公告列表失败！");this.total=t.count,this.tableData=t.data},searchNotice(){if(""==this.search.keyword)return this.$message("请输入搜索关键词！"),this.search.pagenum=1,this.getNoticeList();this.search.pagenum=1,this.getNoticeList()},handleCurrentChangeFn(t){this.search.pagenum=t,this.getNoticeList()},clearnForm(){this.form.nid="",this.form.title="",this.form.noticedate="",this.form.content=""},sureBtn(){return this.isEdit?this.updateNoticeFn():this.addNoticeFn()}},mounted(){this.getNoticeList()}},n=r,l=a(1001),c=(0,l.Z)(n,i,s,!1,null,"6da6e3eb",null),d=c.exports}}]);
//# sourceMappingURL=371.1f42073f.js.map