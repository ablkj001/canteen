"use strict";(self["webpackChunkschool_canteen_shop_backstage"]=self["webpackChunkschool_canteen_shop_backstage"]||[]).push([[789],{5789:function(e,r,t){t.r(r),t.d(r,{default:function(){return i}});var s=function(){var e=this,r=e._self._c;return r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("重置密码")])]),r("el-form",{ref:"pwdFormRef",attrs:{model:e.pwdForm,rules:e.pwdFormRules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"原密码",prop:"old_pwd"}},[r("el-input",{attrs:{type:"password"},model:{value:e.pwdForm.old_pwd,callback:function(r){e.$set(e.pwdForm,"old_pwd",r)},expression:"pwdForm.old_pwd"}})],1),r("el-form-item",{attrs:{label:"新密码",prop:"new_pwd"}},[r("el-input",{attrs:{type:"password"},model:{value:e.pwdForm.new_pwd,callback:function(r){e.$set(e.pwdForm,"new_pwd",r)},expression:"pwdForm.new_pwd"}})],1),r("el-form-item",{attrs:{label:"确认新密码",prop:"re_pwd"}},[r("el-input",{attrs:{type:"password"},model:{value:e.pwdForm.re_pwd,callback:function(r){e.$set(e.pwdForm,"re_pwd",r)},expression:"pwdForm.re_pwd"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.updatePwdFn}},[e._v("修改密码")]),r("el-button",{on:{click:e.reSet}},[e._v("重置")])],1)],1)],1)},d=[],o=(t(7658),t(586)),p={name:"UserPwd",data(){return{pwdForm:{old_pwd:"",new_pwd:"",re_pwd:""},pwdFormRules:{old_pwd:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^\S{6,15}$/,message:"密码长度必须是6-15位的非空字符串",trigger:"blur"},{validator:this.pwdOK,trigger:"blur"}],new_pwd:[{required:!0,message:"请输入新密码",trigger:"blur"},{pattern:/^\S{6,15}$/,message:"密码长度必须是6-15位的非空字符串",trigger:"blur"},{validator:this.samePwd,trigger:"blur"}],re_pwd:[{required:!0,message:"请再次确认新密码",trigger:"blur"},{pattern:/^\S{6,15}$/,message:"密码长度必须是6-15位的非空字符串",trigger:"blur"},{validator:this.rePwd,trigger:"blur"}]}}},methods:{reSet(){this.$refs.pwdFormRef.resetFields()},updatePwdFn(){console.log("提交"),this.$refs.pwdFormRef.validate((async e=>{if(console.log(e),!e)return!1;const{data:r}=await(0,o.AM)({uid:this.$store.state.userInfo.uid,pwd:this.pwdForm.new_pwd,old_pwd:this.pwdForm.old_pwd,re_pwd:this.pwdForm.re_pwd});if(0!==r.code)return this.$message.error("更新密码失败！");console.log(r),this.$message.success("更新密码成功！请重新登录。"),this.$store.commit("updateToken",""),this.$store.commit("updateUserInfo",{}),this.$router.push("/login")}))},pwdOK(e,r,t){if(r!==this.$store.state.userInfo.pwd)return t(new Error("原密码错误！"));t()},samePwd(e,r,t){if(r===this.pwdForm.old_pwd)return t(new Error("新旧密码不能相同！"));t()},rePwd(e,r,t){if(r!==this.pwdForm.new_pwd)return t(new Error("两次密码不相同！"));t()}}},a=p,l=t(1001),w=(0,l.Z)(a,s,d,!1,null,"45b4dbf2",null),i=w.exports}}]);
//# sourceMappingURL=789.d9946b78.js.map